{"version":3,"sources":["services/firebase.js","hooks/use-user.js","components/header.js","components/profile/header.js","components/profile/photos.js","components/profile/index.js","pages/profile.js"],"names":["doesUsernameExist","username","a","firebase","firestore","collection","where","get","result","docs","map","user","data","lenght","getUserByUsername","item","docId","id","getUserByUserId","userId","getSuggestedProfiles","following","limit","filter","profile","includes","updateLoggedInUserFollowing","loggedInUserDocId","profileId","isFollowingProfile","doc","update","FieldValue","arrayRemove","arrayUnion","updateFollowedUserFollowers","profileDocId","followers","getPhotos","userFollowedPhotos","photo","Promise","all","userLikedPhoto","likes","photosWithUserDetails","getUserPhotosByUsername","isUserFollowingProfile","loggedInUserUsername","profileUserId","response","toggleFollow","activeUserDocId","followingUserId","useUser","useState","activeUser","setActiveUser","useEffect","getUserObjByUserId","Header","loggedInUser","useContext","UserContext","uid","FirebaseContext","history","useHistory","className","to","ROUTES","src","alt","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","type","title","onClick","auth","signOut","push","onKeyDown","event","key","photosCount","followerCount","setFollowerCount","fullName","profileUsername","setIsFollowingProfile","activeBtnFollow","handleToggleFollow","isLoggedInUserFollowingProfile","isFollowing","length","count","width","height","Photos","photos","imageSrc","caption","fillRule","clipRule","comments","Profile","useReducer","state","newState","photosCollection","dispatch","console","log","getProfileInfoAndPhotos","useParams","setUser","checkUserExists"],"mappings":"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","file":"static/js/8.6672d869.chunk.js","sourcesContent":["import { firebase, FieldValue } from '../lib/firebase';\r\n\r\nexport async function doesUsernameExist(username) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .where('username', '==', username)\r\n    .get();\r\n\r\n  return result.docs.map((user) => user.data().lenght > 0);\r\n}\r\n\r\nexport async function getUserByUsername(username) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .where('username', '==', username)\r\n    .get();\r\n\r\n  return result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n}\r\n// get user from the firestore where userId === userId (passed from the auth)\r\nexport async function getUserByUserId(userId) {\r\n  const result = await firebase.firestore().collection('users').where('userId', '==', userId).get();\r\n  const user = result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n\r\n  return user;\r\n}\r\n\r\nexport async function getSuggestedProfiles(userId, following) {\r\n  const result = await firebase.firestore().collection('users').limit(10).get();\r\n\r\n  return result.docs\r\n    .map((user) => ({ ...user.data(), docId: user.id }))\r\n    .filter((profile) => profile.userId !== userId && !following.includes(profile.userId));\r\n}\r\n\r\n// updateLoggedInUserFollowing, updateFollowedUserFollowers\r\n\r\nexport async function updateLoggedInUserFollowing(\r\n  loggedInUserDocId, // currently logged in user document id (karl's profile)\r\n  profileId, // the user that karl request to follow\r\n  isFollowingProfile // true/false (am i currently following this person?)\r\n) {\r\n  return firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .doc(loggedInUserDocId)\r\n    .update({\r\n      following: isFollowingProfile\r\n        ? FieldValue.arrayRemove(profileId)\r\n        : FieldValue.arrayUnion(profileId)\r\n    });\r\n}\r\n\r\nexport async function updateFollowedUserFollowers(\r\n  profileDocId, // currently logged in user document id (karl's profile)\r\n  loggedInUserDocId, // the user that karl request to follow\r\n  isFollowingProfile // true/false (am i currently following this person?)\r\n) {\r\n  return firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .doc(profileDocId)\r\n    .update({\r\n      followers: isFollowingProfile\r\n        ? FieldValue.arrayRemove(loggedInUserDocId)\r\n        : FieldValue.arrayUnion(loggedInUserDocId)\r\n    });\r\n}\r\n\r\nexport async function getPhotos(userId, following) {\r\n  // [5,4,2] => following\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('photos')\r\n    .where('userId', 'in', following)\r\n    .get();\r\n\r\n  const userFollowedPhotos = result.docs.map((photo) => ({\r\n    ...photo.data(),\r\n    docId: photo.id\r\n  }));\r\n\r\n  const photosWithUserDetails = await Promise.all(\r\n    userFollowedPhotos.map(async (photo) => {\r\n      let userLikedPhoto = false;\r\n      if (photo.likes.includes(userId)) {\r\n        userLikedPhoto = true;\r\n      }\r\n      // photo.userId = 2\r\n      const user = await getUserByUserId(photo.userId);\r\n      // raphael\r\n      const { username } = user[0];\r\n      return { username, ...photo, userLikedPhoto };\r\n    })\r\n  );\r\n\r\n  return photosWithUserDetails;\r\n}\r\n\r\nexport async function getUserPhotosByUsername(username) {\r\n  const [user] = await getUserByUsername(username);\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('photos')\r\n    .where('userId', '==', user.userId)\r\n    .get();\r\n\r\n  return result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n}\r\n\r\nexport async function isUserFollowingProfile(loggedInUserUsername, profileUserId) {\r\n  const result = await firebase\r\n    .firestore()\r\n    .collection('users')\r\n    .where('username', '==', loggedInUserUsername) // karl (active logged in user)\r\n    .where('following', 'array-contains', profileUserId)\r\n    .get();\r\n\r\n  const [response = {}] = result.docs.map((item) => ({\r\n    ...item.data(),\r\n    docId: item.id\r\n  }));\r\n\r\n  return response.userId;\r\n}\r\n\r\nexport async function toggleFollow(\r\n  isFollowingProfile,\r\n  activeUserDocId,\r\n  profileDocId,\r\n  profileUserId,\r\n  followingUserId\r\n) {\r\n  // 1st param: karl's doc id\r\n  // 2nd param: raphael's user id\r\n  // 3rd param: is the user following this profile? e.g does karl follow raphael? (true/false)\r\n  await updateLoggedInUserFollowing(activeUserDocId, profileUserId, isFollowingProfile);\r\n\r\n  // 1st param: karl's user id\r\n  // 2nd param: raphael's doc id\r\n  // 3rd param: is the user following this profile? e.g does karl follow raphael? (true/false)\r\n  await updateFollowedUserFollowers(profileDocId, followingUserId, isFollowingProfile);\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { getUserByUserId } from '../services/firebase';\r\n\r\nexport default function useUser(userId) {\r\n  const [activeUser, setActiveUser] = useState({});\r\n\r\n  useEffect(() => {\r\n    async function getUserObjByUserId(userId) {\r\n      // we need a function that we can call (firebase service) that gets the user data based on the id\r\n      const [user] = await getUserByUserId(userId);\r\n      setActiveUser(user || {});\r\n    }\r\n    if (userId) {\r\n      getUserObjByUserId(userId);\r\n    }\r\n  }, [userId]);\r\n\r\n  return { user: activeUser };\r\n}\r\n","import { useContext } from 'react';\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport FirebaseContext from '../context/firebase';\r\nimport UserContext from '../context/user';\r\nimport * as ROUTES from '../constants/routes';\r\nimport useUser from '../hooks/use-user';\r\n\r\nexport default function Header() {\r\n  const { user: loggedInUser } = useContext(UserContext);\r\n  const { user } = useUser(loggedInUser?.uid);\r\n  const { firebase } = useContext(FirebaseContext);\r\n  const history = useHistory();\r\n\r\n  return (\r\n    <header className=\"h-16 bg-white border-b border-gray-primary mb-8\">\r\n      <div className=\"container mx-auto max-w-screen-lg h-full\">\r\n        <div className=\"flex justify between h-full\">\r\n          <div className=\"text-gray-700 text-center flex items-center align-items cursor-pointer\">\r\n            <h1 className=\"flex justify-center w-full\">\r\n              <Link to={ROUTES.DASHBOARD} aria-label=\"Instagram logo\">\r\n                <img src=\"/images/logo.png\" alt=\"Instagram\" className=\"mt-2 w-6/12\" />\r\n              </Link>\r\n            </h1>\r\n          </div>\r\n          <div className=\"text-gray-700 text-center flex items-center align-items\">\r\n            {user.username ? (\r\n              <>\r\n                <Link to={ROUTES.DASHBOARD} aria-label=\"Dashboard\">\r\n                  <svg\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    className=\"w-8 mr-6 text-black-light cursor-pointer\"\r\n                    fill=\"none\"\r\n                    viewBox=\"0 0 24 24\"\r\n                    stroke=\"currentColor\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\"\r\n                    />\r\n                  </svg>\r\n                </Link>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  title=\"Sign Out\"\r\n                  onClick={() => {\r\n                    firebase.auth().signOut();\r\n                    history.push(ROUTES.LOGIN);\r\n                  }}\r\n                  onKeyDown={(event) => {\r\n                    if (event.key === 'Enter') {\r\n                      firebase.auth().signOut();\r\n                      history.push(ROUTES.LOGIN);\r\n                    }\r\n                  }}\r\n                >\r\n                  <svg\r\n                    className=\"w-8 mr-6 text-black-light cursor-pointer\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    fill=\"none\"\r\n                    viewBox=\"0 0 24 24\"\r\n                    stroke=\"currentColor\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\"\r\n                    />\r\n                  </svg>\r\n                </button>\r\n                <div className=\"flex items-center cursor-pointer\">\r\n                  <Link to={`/p/${user?.username}`}>\r\n                    <img\r\n                      className=\"rounded-full h-8 w-8 flex\"\r\n                      src={`/images/avatars/${user.username}.jpg`}\r\n                      alt={`${user?.username} profile `}\r\n                    />\r\n                  </Link>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Link to={ROUTES.LOGIN}>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8\"\r\n                  >\r\n                    Log In\r\n                  </button>\r\n                </Link>\r\n                <Link to={ROUTES.SIGN_UP}>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"font-bol text-sm rounded text-blue-medium w-20 h-8\"\r\n                  >\r\n                    Sign Up\r\n                  </button>\r\n                </Link>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </header>\r\n  );\r\n}\r\n","/* eslint-disable jsx-a11y/img-redundant-alt */\r\nimport { useState, useEffect, useContext } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Skeleton from 'react-loading-skeleton';\r\nimport useUser from '../../hooks/use-user';\r\nimport { isUserFollowingProfile, toggleFollow } from '../../services/firebase';\r\nimport UserContext from '../../context/user';\r\n\r\nexport default function Header({\r\n  photosCount,\r\n  followerCount,\r\n  setFollowerCount,\r\n  profile: {\r\n    docId: profileDocId,\r\n    userId: profileUserId,\r\n    fullName,\r\n    followers,\r\n    following,\r\n    username: profileUsername\r\n  }\r\n}) {\r\n  const { user: loggedInUser } = useContext(UserContext);\r\n  const { user } = useUser(loggedInUser?.uid);\r\n  const [isFollowingProfile, setIsFollowingProfile] = useState(false);\r\n  const activeBtnFollow = user?.username && user?.username !== profileUsername;\r\n\r\n  const handleToggleFollow = async () => {\r\n    setIsFollowingProfile((isFollowingProfile) => !isFollowingProfile);\r\n    setFollowerCount({\r\n      followerCount: isFollowingProfile ? followerCount - 1 : followerCount + 1\r\n    });\r\n    await toggleFollow(isFollowingProfile, user.docId, profileDocId, profileUserId, user.userId);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const isLoggedInUserFollowingProfile = async () => {\r\n      const isFollowing = await isUserFollowingProfile(user.username, profileUserId);\r\n      setIsFollowingProfile(!!isFollowing);\r\n    };\r\n\r\n    if (user?.username && profileUserId) {\r\n      isLoggedInUserFollowingProfile();\r\n    }\r\n  }, [user?.username, profileUserId]);\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg\">\r\n      <div className=\"container flex justify-center items-center\">\r\n        {profileUsername ? (\r\n          <img\r\n            className=\"rounded-full h-40 w-40 flex\"\r\n            alt={`${user.username} profile picture`}\r\n            src={`/images/avatars/${profileUsername}.jpg`}\r\n          />\r\n        ) : (\r\n          <img\r\n            className=\"rounded-full h-40 w-40 flex\"\r\n            alt={\"Karl Hadwen's profile picture\"}\r\n            src=\"/images/avatars/karl.jpg\"\r\n          />\r\n        )}\r\n      </div>\r\n      <div className=\"flex items-center justify-center flex-col col-sapn-2\">\r\n        <div className=\"container flex items-center\">\r\n          <p className=\"text-2xl mr-4\">{profileUsername}</p>\r\n          {activeBtnFollow && (\r\n            <button\r\n              className=\"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8\"\r\n              type=\"button\"\r\n              onClick={handleToggleFollow}\r\n              onKeyDown={(event) => {\r\n                if (event.key === 'Enter') {\r\n                  handleToggleFollow();\r\n                }\r\n              }}\r\n            >\r\n              {isFollowingProfile ? 'Unfollow' : 'Follow'}\r\n            </button>\r\n          )}\r\n        </div>\r\n        <div className=\"container flex mt-4\">\r\n          {!followers || !following ? (\r\n            <Skeleton count={1} width={677} height={24} />\r\n          ) : (\r\n            <>\r\n              <p className=\"mr-10\">\r\n                <span className=\"font-bold\">{photosCount}</span> photos\r\n              </p>\r\n              <p className=\"mr-10\">\r\n                <span className=\"font-bold\">{followerCount}</span>\r\n                {` `}\r\n                {followers.length === 1 ? `follower` : `followers`}\r\n              </p>\r\n              <p className=\"mr-10\">\r\n                <span className=\"font-bold\">{following.length}</span> following\r\n              </p>\r\n            </>\r\n          )}\r\n        </div>\r\n        <div className=\"container mt-4\">\r\n          <p className=\"font-medium\">{!fullName ? <Skeleton count={1} height={24} /> : fullName}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nHeader.propTypes = {\r\n  photosCount: PropTypes.number.isRequired,\r\n  followerCount: PropTypes.number.isRequired,\r\n  setFollowerCount: PropTypes.func.isRequired,\r\n  profile: PropTypes.shape({\r\n    docId: PropTypes.string,\r\n    userId: PropTypes.string,\r\n    fullName: PropTypes.string,\r\n    username: PropTypes.string,\r\n    followers: PropTypes.array,\r\n    following: PropTypes.array\r\n  }).isRequired\r\n};\r\n","import PropTypes from 'prop-types';\r\nimport Skeleton from 'react-loading-skeleton';\r\n\r\nexport default function Photos({ photos }) {\r\n  return (\r\n    <div className=\"h-16 border-t border-gray-primary mt-12 pt-4\">\r\n      <div className=\"grid grid-cols-3 gap-8 mt-4 mb-12\">\r\n        {!photos ? (\r\n          <>\r\n            <Skeleton count={12} width={320} height={400} />\r\n          </>\r\n        ) : photos.length > 0 ? (\r\n          photos.map((photo) => (\r\n            <div key={photo.docId} className=\"relative group\">\r\n              <img src={photo.imageSrc} alt={photo.caption} />\r\n\r\n              <div className=\"absolute bottom-0 left-0 bg-gray -200 z-10 w-full justify-evenly items-center h-full bg-black-faded group-hover:flex hidden\">\r\n                <p className=\"flex items-center text-white font-bold\">\r\n                  <svg\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 20 20\"\r\n                    fill=\"currentColor\"\r\n                    className=\"w-8 mr-4\"\r\n                  >\r\n                    <path\r\n                      fillRule=\"evenodd\"\r\n                      d=\"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z\"\r\n                      clipRule=\"evenodd\"\r\n                    />\r\n                  </svg>\r\n                  {photo.likes.length}\r\n                </p>\r\n\r\n                <p className=\"flex items-center text-white font-bold\">\r\n                  <svg\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    viewBox=\"0 0 20 20\"\r\n                    fill=\"currentColor\"\r\n                    className=\"w-8 mr-4\"\r\n                  >\r\n                    <path\r\n                      fillRule=\"evenodd\"\r\n                      d=\"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z\"\r\n                      clipRule=\"evenodd\"\r\n                    />\r\n                  </svg>\r\n                  {photo.comments.length}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ))\r\n        ) : null}\r\n      </div>\r\n\r\n      {!photos || (photos.length === 0 && <p className=\"text-center text-2xl\"> No Posts Yet!</p>)}\r\n    </div>\r\n  );\r\n}\r\n\r\nPhotos.propTypes = {\r\n  photos: PropTypes.array.isRequired\r\n};\r\n","import { useReducer, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Header from './header';\r\nimport Photos from './photos';\r\nimport {\r\n  getUserPhotosByUsername,\r\n  updateFollowedUserFollowers,\r\n  updateLoggedInUserFollowing\r\n} from '../../services/firebase';\r\n\r\nexport default function Profile({ user }) {\r\n  const reducer = (state, newState) => ({ ...state, ...newState });\r\n  const initialState = {\r\n    profile: {},\r\n    photosCollection: [],\r\n    followerCount: 0\r\n  };\r\n  const [{ profile, photosCollection, followerCount }, dispatch] = useReducer(\r\n    reducer,\r\n    initialState\r\n  );\r\n\r\n  useEffect(() => {\r\n    async function getProfileInfoAndPhotos() {\r\n      console.log('user', user);\r\n      const photos = await getUserPhotosByUsername(user.username);\r\n      dispatch({ profile: user, photosCollection: photos, followerCount: user.followers.length });\r\n    }\r\n    if (user.username) {\r\n      getProfileInfoAndPhotos();\r\n    }\r\n  }, [user.username]);\r\n  return (\r\n    <>\r\n      <Header\r\n        photosCount={photosCollection ? photosCollection.length : 0}\r\n        profile={profile}\r\n        followerCount={followerCount}\r\n        setFollowerCount={dispatch}\r\n      />\r\n      <Photos photos={photosCollection} />\r\n    </>\r\n  );\r\n}\r\nProfile.propTypes = {\r\n  user: PropTypes.shape({\r\n    dateCreated: PropTypes.number,\r\n    emailAddress: PropTypes.string,\r\n    followers: PropTypes.array,\r\n    following: PropTypes.array,\r\n    fullName: PropTypes.string,\r\n    userId: PropTypes.string,\r\n    username: PropTypes.string\r\n  })\r\n};\r\n","import { useParams, useHistory } from 'react-router-dom';\r\nimport { useState, useEffect } from 'react';\r\nimport { getUserByUsername } from '../services/firebase';\r\nimport * as ROUTES from '../constants/routes';\r\nimport Header from '../components/header';\r\nimport UserProfile from '../components/profile';\r\n\r\nexport default function Profile() {\r\n  const { username } = useParams();\r\n  const [user, setUser] = useState(null);\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    async function checkUserExists() {\r\n      const [user] = await getUserByUsername(username);\r\n      if (user?.userId) {\r\n        setUser(user);\r\n      } else {\r\n        history.push(ROUTES.NOT_FOUND);\r\n      }\r\n    }\r\n\r\n    checkUserExists();\r\n  }, [username, history]);\r\n\r\n  return user?.username ? (\r\n    <div className=\"bg-gray-background\">\r\n      <Header />\r\n      <div className=\"mx-auto max-w-screen-lg\">\r\n        <UserProfile user={user} />\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n}\r\n"],"sourceRoot":""}